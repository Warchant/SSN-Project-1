<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0032)http://www.controlf.net/regexps/ -->
<html xmlns="http://www.w3.org/1999/xhtml"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="google-site-verification" content="w8geEYfhznLEnTa5rWWBCpRSx8BT1QIGF7nKT_8mhXU">
<title>Regular Expressions &amp; Search Terms for Phone Examiners | Control-F</title>
<link rel="stylesheet" href="./Regular Expressions & Search Terms for Phone Examiners   Control-F_files/style.css" type="text/css" media="screen">
<link rel="shortcut icon" href="http://www.controlf.net/favicon.ico">
<link rel="alternate" type="application/rss+xml" title="Control-F RSS Feed" href="http://www.controlf.net/feed/">
<link rel="alternate" type="application/atom+xml" title="Control-F Atom Feed" href="http://www.controlf.net/feed/atom/">
<link rel="pingback" href="http://www.controlf.net/wordpress/xmlrpc.php">
<script type="text/javascript" async="" src="./Regular Expressions & Search Terms for Phone Examiners   Control-F_files/ga.js"></script><script type="text/javascript" src="./Regular Expressions & Search Terms for Phone Examiners   Control-F_files/comment-reply.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.controlf.net/wordpress/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.controlf.net/wordpress/wp-includes/wlwmanifest.xml"> 
<link rel="index" title="Control-F" href="http://www.controlf.net/">
<meta name="generator" content="WordPress 2.8.4">

<!-- All in One SEO Pack 1.6.12.2 by Michael Torbert of Semper Fi Web Design[-1,-1] -->
<link rel="canonical" href="./Regular Expressions & Search Terms for Phone Examiners   Control-F_files/Regular Expressions & Search Terms for Phone Examiners   Control-F.htm">
<!-- /all in one seo pack -->
</head>
<body>
<div id="topstrip">
  <div id="leader">
  <div id="contactf">
      <a href="http://www.controlf.net/feed/"><img src="./Regular Expressions & Search Terms for Phone Examiners   Control-F_files/feed.gif" alt="RSS Feed"></a>
    </div>
    <a href="http://www.controlf.net/"><img src="./Regular Expressions & Search Terms for Phone Examiners   Control-F_files/ControlF_TM_White_RGB.png" alt="Control F Digital Forensics" id="logo"></a>
    <ul id="menu">
      <li class="page_item page-item-4"><a href="http://www.controlf.net/" title="Home">Home</a></li>
<li class="page_item page-item-6"><a href="http://www.controlf.net/training/" title="Training">Training</a></li>
<li class="page_item page-item-1286"><a href="http://www.controlf.net/testimonials/" title="Testimonials">Testimonials</a></li>
<li class="page_item page-item-1276"><a href="http://www.controlf.net/downloads/" title="Free Stuff">Free Stuff</a></li>
<li class="page_item page-item-1270"><a href="http://www.controlf.net/about/" title="About">About</a></li>
<li class="page_item page-item-10"><a href="http://www.controlf.net/contact/" title="Contact">Contact</a></li>
 
    </ul>
  </div>
</div>
<div id="midstrip">
  <div id="main">
    <div id="content">
    
            <div class="post" id="post-870">
        <div class="entry">
        <h1 style="text-align: center;">Regular Expressions &amp; Search Terms</h1>
<h1 style="text-align: center;">for Phone Examiners</h1>
<p style="text-align: justify;">This page is intended to act as a resource for phone forensic examiners who are working with physical extractions (”hex dumps”) of mobile phone handsets. It aims to provide advice as well as usable search terms and regular expressions that phone examiners can use to find key data within a mass of hex data.</p>
<p style="text-align: justify;">The page is split into two sections to reflect that certain types of data are commonly stored as files (e.g. video, MMS etc.) whereas other data types such as previous SIM details may be stored as individual “records” rather than in files. Do also refer to <a title="Gary Kessler&#39;s File Signature Page" href="http://www.garykessler.net/library/file_sigs.html" target="_blank">Gary Kessler’s excellent file signature page</a> – we can’t live without it!</p>
<p style="text-align: justify;">
</p><h2>Non File Based</h2>
<table border="1" cellspacing="0" cellpadding="5" width="100%">
<tbody>
<tr>
<td style="padding:5px;" width="25%"><strong>Data Type</strong></td>
<td style="padding:5px;" width="25%"><strong>Example (decoded)</strong></td>
<td style="padding:5px;" width="25%"><strong>Info on format</strong></td>
<td style="padding:5px;" width="25%"><strong>Suggested search / regexp</strong></td>
</tr>
<tr>
<td style="padding:5px;">IMSI</td>
<td style="padding:5px;">234105563888549</td>
<td style="padding:5px;"><a title="IMSI page on Wikipedia" href="http://en.wikipedia.org/wiki/IMSI" target="_blank">http://en.wikipedia.org/wiki/IMSI</a></td>
<td style="padding:5px;">Country/region specific – See below</td>
</tr>
<tr>
<td style="text-align: justify; padding: 5px;" colspan="4">IMSI prefixes are country specific so a single global IMSI search probably doesn’t make sense (and would return too many ‘false positive’ hits). Encoding of the IMSI within the handset memory will vary, but some handsets will follow the SIM card standards and store the IMSI in hex in a reverse nibbled decimal format.For example, the IMSI <strong>234105563888549</strong> would appear as the hex <strong>29 43 01 55 36 88 58 94</strong>. Some Samsung and Nokia handsets certainly use this approach.IMSIs are normally 15 digits long, the trailing “9” in the&nbsp;above example&nbsp;creates 8 pairs of hex digits. IMSIs start with the Mobile Country Code (for the UK this is “234”)&nbsp;which is followed by&nbsp;the Mobile Network Code. In the UK, the MNCs “10”, “15”, “20”, “30” and “33” are used by the five UK networks O2, Vodafone, 3, T-Mobile and Orange respectively.So the following regular expression:<p></p>
<pre style="text-align: center;">\x29\x43[\x01|\x02|\x03|\x33|\x51]</pre>
<p>could be used to find all occurrences of the five valid UK IMSI prefixes.</p>
<p>The regular expression could be extended to specify that the remaining 9 characters must be digits, but this makes the regular expression much longer and somewhat confusing (due to the fact that we are writing a regular expression to match hex rather than one to match text).</p>
<p>Some Samsung handsets (e.g. E1080i, E1120) appear to always store</p>
<pre style="text-align: center;">\x11\xF2\xFF</pre>
<p>directly after the IMSI. Hence the regular expression above can be extended to include the last 5 bytes of the IMSI and this (Samsung-specific) trailer:</p>
<pre style="text-align: center;">\x29\x43[\x01|\x02|\x03|\x33|\x51].{5}\x11\xF2\xFF</pre>
</td>
</tr>
</tbody>
</table>
<table border="1" cellspacing="0" cellpadding="5" width="100%">
<tbody>
<tr>
<td style="padding:5px;" width="25%"><strong>Data Type</strong></td>
<td style="padding:5px;" width="25%"><strong>Example (decoded)</strong></td>
<td style="padding:5px;" width="25%"><strong>Info on format</strong></td>
<td style="padding:5px;" width="25%"><strong>Suggested search / regexp</strong></td>
</tr>
<tr>
<td style="padding:5px;">ICCID</td>
<td style="padding:5px;">8944110064815443720</td>
<td style="padding:5px;"><a title="SIM page on Wikipedia" href="http://en.wikipedia.org/wiki/ICCID#ICCID" target="_blank">http://en.wikipedia.org/wiki/ICCID#ICCID</a></td>
<td style="padding:5px;">Country/region specific – See below</td>
</tr>
<tr>
<td style="text-align: justify; padding: 5px;" colspan="4">ICCID prefixes are also country specific and country-specific searching is a good place to start. ICCIDs are also often stored (as per the SIM standards) in hex in reverse nibbled decimal format like IMSIs See the notes above on IMSI encoding.ICCIDs are normally 19 or 20 digits long, so expect 10 pairs of hex digits, possibly using an “F” as padding &nbsp;if the ICCID was only 19 digits long (that’s how it’s done on the SIM and hence some manufacturers will follow this). All ICCIDs start “89″ followed by the dialling code for that country and then a two digit identifier for the issuing service provider (known as the Issuer Identifier Number).&nbsp;For example, all&nbsp;UK SIM cards all start “8944” and the Issuer Identifier Numbers&nbsp; “10”, “11”, “20”, “30” and “12” are used by the five networks Vodafone, O2, 3, T-Mobile and Orange respectively.So the following regular expression:<p></p>
<pre style="text-align: center;">\x98\x44[\x01|\x02|\x03|\x11|\x21]</pre>
<p>could be used to find all occurrences of the five valid UK ICCID prefixes.</p></td>
</tr>
</tbody>
</table>
<table border="1" cellspacing="0" cellpadding="5" width="100%">
<tbody>
<tr>
<td style="padding:5px;" width="25%"><strong>Data Type</strong></td>
<td style="padding:5px;" width="25%"><strong>Example (decoded)</strong></td>
<td style="padding:5px;" width="25%"><strong>Info on format</strong></td>
<td style="padding:5px;" width="25%"><strong>Suggested search / regexp</strong></td>
</tr>
<tr>
<td style="padding:5px;">SMS</td>
<td style="padding:5px;">N/A</td>
<td style="padding:5px;"><a title="GSM Alphabet page on Wikipedia" href="http://en.wikipedia.org/wiki/GSM_03.38" target="_blank">GSM 03.38 (GSM 7 Bit Alphabet)</a><p></p>
<p>GSM03.40</p>
<p><a title="SMS on Dreamfabric" href="http://www.dreamfabric.com/sms/" target="_blank">http://www.dreamfabric.com/sms/</a></p></td>
<td style="padding:5px;">Country/region specific – See below</td>
</tr>
<tr>
<td style="text-align: justify;" colspan="4">Format for transmission of SMS across the network (and storage on the SIM) is standardised, but copies of SMS in handset memory (or on removable media) are often manufacturer-specific. It makes sense to start by looking for SMS using the GSM standard format and then adjusting the search based on the results.The start of a GSM standard SMS header includes the phone number of the SMSC responsible for handling the message as well as the length of that phone number. The length and format of phone numbers varies from country to country, so it is most practical to start by looking for SMS which have SMSC numbers relating to a specific country. The very first byte of a standards-based SMS is the status of the message which could be “00” (deleted) , “01”&nbsp; (read),&nbsp; “03” (unread),&nbsp; “05” (sent) or “07” (unsent). The second byte stores the&nbsp;length of the SMSC number counted in bytes (including the Type of Number field which itself is 1 byte long) which should be consistent within a particular country. The Type of Number (TON) field is usually set to “91” for the SMSC number. This indicates that the number which follows is in international format (e.g. “447958879884”) – again the first few digits of the SMSC number will be the country code which can be included in the search expression. Taking the UK as an example, a typical SMS header for a read message might look like:<p></p>
<p align="center">01 07 91 44</p>
<p>We can choose to ignore the status byte in our search (as manufacturers may have chosen to not include this) and just search for the characteristic “07 91 44” string.&nbsp; So, to search for SMS relating relating to UK subscribers, we could use the regular expression:</p>
<pre style="text-align: center;">\x07\x91\x44</pre>
<p>This search term <span style="text-decoration: underline;">may</span> identify SMS present within a memory dump. Further work will be required to determine the actual start and end of the SMS message. The message content itself is quite possibly encoded using the GSM 7-bit alphabet (i.e. not ASCII) so don’t expect the words of the text message to jump out at you!</p>
<p>Some Samsung handsets (e.g. D500, D600 etc.) use the keyword “DEADBEEF” as a delimiter between text messages in the handset memory. Running a ASCII text search for “DEADBEEF” on such a handset should yield results – and if you are searching the OneNAND raw memory then you’ll be looking at live and deleted messages (only live messages can be recovered from the FAT file system layer).</p></td>
</tr>
</tbody>
</table>
<h2>File Based</h2>
<table border="1" cellspacing="0" cellpadding="5" width="100%">
<tbody>
<tr>
<td style="padding:5px;" width="33%"><strong>Data Type</strong></td>
<td style="padding:5px;" width="33%"><strong>Info on format</strong></td>
<td style="padding:5px;" width="34%"><strong>Suggested search / regexp</strong></td>
</tr>
<tr>
<td style="padding:5px;">MMS</td>
<td style="padding:5px;"><a title="MMS Encapsulation Protocol" href="http://www.openmobilealliance.org/Technical/release_program/docs/CopyrightClick.aspx?pck=MMS&file=V1_3-20080128-C/OMA-TS-MMS-ENC-V1_3-20080128-C.pdf" target="_blank">MMS Encapsulation Protocol (Candidate Version 1.3, 28-Jan-2008), Open Mobile Alliance</a><p></p>
<p><a title="MMS Conformance Document" href="http://www.openmobilealliance.org/Technical/release_program/docs/CopyrightClick.aspx?pck=MMS&file=V1_3-20080128-C/OMA-TS-MMS-CONF-V1_3-20080128-C.pdf" target="_blank">MMS Conformance Document (Candidate Version 1.3, 28-Jan-2008), Open Mobile Alliance</a></p></td>
<td style="padding:5px;">
<pre>\x8C[\x80\x84]\x98</pre>
<pre><em>OR</em></pre>
<pre>&lt;smil</pre>
</td>
</tr>
<tr>
<td style="text-align: justify; padding: 5px;" colspan="3">Format for transmission is standardised but copies of MMS in handset memory are often in manufacturer-specific format.<em> </em>If the manufacturer has stored the message in a proprietary format, it may still be able to locate them using an ASCII text search for “&lt;smil” which should appear near the start of a message.&nbsp;MMS messages start with a “tag” (0×8C) which indicates that the first header field will be the message type (which itself is one byte long). The message types of most interest are 0×80 (sent messages) and 0×84 (received messages). The&nbsp;third byte&nbsp;in the message should be the tag 0×98 which indicates that the second header field that follows is the Transaction-ID.As such, we can search for all sent and received messages with the regular expression:<p></p>
<pre style="text-align: center;">\x8C[\x80\x84]\x98</pre>
</td>
</tr>
</tbody>
</table>
<table border="1" cellspacing="0" cellpadding="5" width="100%">
<tbody>
<tr>
<td style="padding:5px;" width="33%"><strong>Data Type</strong></td>
<td style="padding:5px;" width="33%"><strong>Info on format</strong></td>
<td style="padding:5px;" width="34%"><strong>Suggested search / regexp</strong></td>
</tr>
<tr>
<td style="padding:5px;">3GP / MP4</td>
<td style="padding:5px;">MP4 file format defined in <a title="MP4-Part 14 page on Wikipedia" href="http://en.wikipedia.org/wiki/MP4" target="_blank">MPEG Part 14</a> (ISO/IEC 14496-14:2003)</td>
<td style="padding:5px;">
<pre>\x00\x00\x00.\x66\x74\x79\x70</pre>
</td>
</tr>
<tr>
<td style="padding:5px;" colspan="3">Commonly encountered “4th byte” values are 0×14, 0×18, 0×1C, 0×20. The regular expression above will match on 3GP/MP4 headers with any value present in the 4th byte.</td>
</tr>
</tbody>
</table>
        </div>
      </div>

            
<!-- You can start editing here. -->


			<!-- If comments are closed. -->
		<p class="nocomments">Comments are closed.</p>

	


    </div>
    <div id="sidebar">
  <ul>
    <li id="controlf_whats_new" class="widget controlf_whats_new">  <h2>What's New</h2>
  <div class="textwidget">
    <p><a href="http://www.controlf.net/news/new-python-scripting-course-launched/">New Python Scripting course launched</a></p>
    <p>Dates and pricing announced for our new <a href="http://www.controlf.net/training/ps1">Python Scripting 1</a> course. Learn how to write simple scripts to make you a more effective digital forensic examiner</p>
    <p><a href="http://www.controlf.net/news/"><strong>Read all news</strong></a></p>
  </div>
  </li><li id="text-441150831" class="widget widget_text"><h2 class="widgettitle">Sign up and keep in touch</h2>			<div class="textwidget"><div id="pleasesignup">Sign up to receive regular updates about training courses, useful downloads and other services.</div>
<div id="signup">
<form action="http://controlf.createsend.com/t/r/s/jlvul/" method="post">
<div id="signupelems">
<input type="text" name="cm-name" id="name">
<label for="name">Name</label>
<input type="text" name="cm-jlvul-jlvul" id="jlvul-jlvul">
<label for="jlvul-jlvul">Email</label>
<input type="text" name="cm-f-ptlku" id="Organisation">
<label for="Organisation">Organisation</label>
</div>
<button type="submit">Sign Up</button>
</form>
<p>Your email address is safe with us, we use <a href="http://www.campaignmonitor.com/">Campaign Monitor</a></p></div></div>
		</li><li id="text-441150832" class="widget widget_text"><h2 class="widgettitle">Luhn Check Algorithm</h2>			<div class="textwidget"><script language="javascript">
 // Javascript code copyright 2009 by Fiach Reid : www.webtropy.com
 // This code may be used freely, as long as this copyright notice is intact.
 function Calculate(Luhn)
 {
	var sum = 0;
    for (i=0; i<Luhn.length; i++ )
    {
		sum += parseInt(Luhn.substring(i,i+1));
    }
	var delta = new Array (0,1,2,3,4,-4,-3,-2,-1,0);
	for (i=Luhn.length-1; i>=0; i-=2 )
    {		
		var deltaIndex = parseInt(Luhn.substring(i,i+1));
		var deltaValue = delta[deltaIndex];	
		sum += deltaValue;
	}	
	var mod10 = sum % 10;
	mod10 = 10 - mod10;	
	if (mod10==10)
	{		
		mod10=0;
	}
	return mod10;
 }

 function Validate(Luhn)
 {
	var LuhnDigit = parseInt(Luhn.substring(Luhn.length-1,Luhn.length));
	var LuhnLess = Luhn.substring(0,Luhn.length-1);
	if (Calculate(LuhnLess)==parseInt(LuhnDigit))
	{
		return true;
	}	
	return false;
 }
</script>
Calculate the check digit for an IMEI (or ICCID) or validate that the last digit is correct
<form name="LuhnForm">
 <table width="100%" border="0" cellspacing="5" cellpadding="5">
 <tbody><tr>
     <td colspan="2"><div align="center">
   <input type="text" name="luhn" id="luhn">
 </div></td>
    </tr>
   <tr>
     <td><div align="center">
       <input type="button" onclick="document.getElementById(&#39;luhn&#39;).value += Calculate(document.getElementById(&#39;luhn&#39;).value)" value="Calculate Luhn">
     </div></td>
     <td><div align="center">
       <input type="button" onclick="alert(Validate(document.getElementById(&#39;luhn&#39;).value))" value="Validate Luhn">
     </div></td>
    </tr>
 </tbody></table>
</form></div>
		</li>  </ul>
</div>
    
  </div><!-- #main -->
</div><!-- #midstrip -->

<div id="lowstrip">
  <div id="footer">
    <div id="contact">
      +44 (0)20 8133 8758<br>
      <a href="mailto:info@controlf.net">info@controlf.net</a>
    </div>
    <div id="contactp">
      tel:<br>
      email:
    </div>
    <em>'We Make It Make Sense'</em>
  </div>
  <div id="legal">
    <div id="copyright">
      ©2013 Control-F
    </div>
    <div id="cnumber">
      Company number: 6018835 - Registered office: Amelia House, Crescent Road, Worthing, West Sussex BN11 1QR
    </div>
  </div>
</div>

<!-- Google analytics -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-18901638-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- Site by pepsmedia.com -->



</body></html>